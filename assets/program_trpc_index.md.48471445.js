import{_ as s,o as n,c as a,U as p}from"./chunks/framework.0f008bc5.js";const A=JSON.parse('{"title":"tRPC æ˜¯ä»€ä¹ˆï¼Ÿä¸ REST å’Œ GraphQL æœ‰å•¥å…³ç³» | ä½ å¯èƒ½ä¸å†éœ€è¦ä¼ ç»Ÿçš„ APIï¼","description":"","frontmatter":{"author":"Kano","date":"2023-05-28T00:00:00.000Z"},"headers":[],"relativePath":"program/trpc/index.md","filePath":"program/trpc/index.md","lastUpdated":1690359404000}'),l={name:"program/trpc/index.md"},o=p(`<h1 id="trpc-æ˜¯ä»€ä¹ˆ-ä¸-rest-å’Œ-graphql-æœ‰å•¥å…³ç³»-ä½ å¯èƒ½ä¸å†éœ€è¦ä¼ ç»Ÿçš„-api" tabindex="-1">tRPC æ˜¯ä»€ä¹ˆï¼Ÿä¸ REST å’Œ GraphQL æœ‰å•¥å…³ç³» | ä½ å¯èƒ½ä¸å†éœ€è¦ä¼ ç»Ÿçš„ APIï¼ <a class="header-anchor" href="#trpc-æ˜¯ä»€ä¹ˆ-ä¸-rest-å’Œ-graphql-æœ‰å•¥å…³ç³»-ä½ å¯èƒ½ä¸å†éœ€è¦ä¼ ç»Ÿçš„-api" aria-label="Permalink to &quot;tRPC æ˜¯ä»€ä¹ˆï¼Ÿä¸ REST å’Œ GraphQL æœ‰å•¥å…³ç³» | ä½ å¯èƒ½ä¸å†éœ€è¦ä¼ ç»Ÿçš„ APIï¼&quot;">â€‹</a></h1><h2 id="ä»€ä¹ˆæ˜¯-trpc" tabindex="-1">ä»€ä¹ˆæ˜¯ tRPC <a class="header-anchor" href="#ä»€ä¹ˆæ˜¯-trpc" aria-label="Permalink to &quot;ä»€ä¹ˆæ˜¯ tRPC&quot;">â€‹</a></h2><p>tRPC æ˜¯ä¸€ä¸ªåŸºäº TypeScript çš„ RPC æ¡†æ¶ï¼Œå®ƒçš„ç›®æ ‡æ˜¯è®©å‰åç«¯çš„å¼€å‘è€…å¯ä»¥åƒè°ƒç”¨æœ¬åœ°å‡½æ•°ä¸€æ ·è°ƒç”¨è¿œç¨‹å‡½æ•°ï¼Œè€Œä¸ç”¨å…³å¿ƒåº•å±‚çš„ç½‘ç»œé€šä¿¡ç»†èŠ‚ã€‚</p><p>tRPC çš„ç›®æ ‡æ˜¯è®©å‰åç«¯çš„å¼€å‘è€…å¯ä»¥åƒè°ƒç”¨æœ¬åœ°å‡½æ•°ä¸€æ ·è°ƒç”¨è¿œç¨‹å‡½æ•°ï¼Œè€Œä¸ç”¨å…³å¿ƒåº•å±‚çš„ç½‘ç»œé€šä¿¡ç»†èŠ‚ã€‚</p><p>ç›¸å…³ç‰¹ç‚¹å¯ä»¥ä» <a href="https://trpc.io/" target="_blank" rel="noreferrer">tRPC å®˜ç½‘</a></p><p>ç›´æ¥çœ‹åˆ°ï¼Œè¿™é‡Œå°±ä¸æ¬è¿å®˜ç½‘å†…å®¹äº†ã€‚</p><h2 id="æœ¬æ–‡å†…å®¹" tabindex="-1">æœ¬æ–‡å†…å®¹ <a class="header-anchor" href="#æœ¬æ–‡å†…å®¹" aria-label="Permalink to &quot;æœ¬æ–‡å†…å®¹&quot;">â€‹</a></h2><p>æœ¬æ–‡ä¼šå¸¦ä½ å®ç°ä¸€ä¸ªæç®€çš„ tRPC é¡¹ç›®ï¼Œå®ç° <code>examples-minimal</code>ã€‚</p><blockquote><p>ç›¸å…³æºç å¦‚ä¸‹ï¼š</p></blockquote><p><a href="https://github.com/chonext/trpc-practice/tree/main/examples-minimal" target="_blank" rel="noreferrer">examples-minimal é¡¹ç›®æºç </a></p><p>tRPC åˆ†ä¸ºå‡ ä¸ªåŒ…ï¼Œæ‰€ä»¥ä½ å¯ä»¥åªå®‰è£…ä½ éœ€è¦çš„ï¼Œç¡®ä¿åœ¨ä»£ç åº“çš„é€‚å½“éƒ¨åˆ†å®‰è£…æ‰€éœ€çš„åŒ…ã€‚</p><p>é¦–å…ˆå®‰è£… <code>@trpc/server</code> å’Œ <code>@trpc/client</code> åŒ…ï¼Œè¿™ä¸¤ä¸ªåŒ…åˆ†åˆ«ä½¿ç”¨äºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ã€‚</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@trpc/server</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">@trpc/client</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="ç¼–å†™åç«¯é€»è¾‘" tabindex="-1">ç¼–å†™åç«¯é€»è¾‘ <a class="header-anchor" href="#ç¼–å†™åç«¯é€»è¾‘" aria-label="Permalink to &quot;ç¼–å†™åç«¯é€»è¾‘&quot;">â€‹</a></h2><p>æˆ‘ä»¬ä¸æ‰“ç®—æŠŠé¡¹ç›®å¼„å¤æ‚äº†ï¼Œå› æ­¤å¯¹äºåç«¯æ•°æ®åº“è€Œè¨€ï¼Œæˆ‘ä»¬ä½¿ç”¨è™šæ‹Ÿçš„ï¼Œç”¨ä¸€ä¸ªæ•°ç»„å³å¯ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p><p><code>server/db.ts</code></p><div class="language-typescript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">User</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">id</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">email</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">password</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// Imaginary database</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> users</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">User</span><span style="color:#A6ACCD;">[] </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> []</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> db </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">user</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">findMany</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> users</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">findById</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">id</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> users</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">find</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">user</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> user</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">id </span><span style="color:#89DDFF;">===</span><span style="color:#A6ACCD;"> id)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">create</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">data</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">email</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">password</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">user</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> id</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">String</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">users</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">data</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">users</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">user</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">user</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>åœ¨æ¨¡æ‹Ÿçš„ <code>db</code> å¯¹è±¡ä¸­æœ‰ä¸€äº›æ•°æ®çš„æ“ä½œæ–¹æ³•ï¼Œå¦‚ <code>findById</code> å’Œ <code>create</code>ï¼Œè¿™äº›æ–¹æ³•ä¼šåœ¨åé¢çš„ä»£ç ä¸­ç”¨åˆ°ï¼Œä¹Ÿå¦‚å­—é¢æ„æ€ä¸€æ ·ï¼Œ<code>findById</code> ç”¨äºæ ¹æ® <code>id</code> æŸ¥æ‰¾ç”¨æˆ·ï¼Œ<code>create</code> ç”¨äºåˆ›å»ºç”¨æˆ·ã€‚</p><p>æ¥ä¸‹æ¥åˆ›å»º <code>server/trpc.ts</code> æ–‡ä»¶ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p><div class="language-typescript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">initTRPC</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">@trpc/server</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * Initialization of tRPC backend</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * Should be done only once per backend!</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> t </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> initTRPC</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">create</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * Export reusable router and procedure helpers</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * that can be used throughout the router</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> router </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> t</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">router</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> publicProcedure </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> t</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">procedure</span><span style="color:#89DDFF;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>åœ¨ <code>server/trpc.ts</code> æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬åˆå§‹åŒ–äº† tRPC åç«¯ï¼Œç„¶åå¯¼å‡ºäº† <code>router</code> å’Œ <code>publicProcedure</code> ä¸¤ä¸ªå˜é‡ï¼Œè¿™ä¸¤ä¸ªå˜é‡ä¼šåœ¨åé¢çš„ä»£ç ä¸­ç”¨åˆ°ã€‚</p><p>æ¥ç€ï¼Œæœ‰äº†å‰é¢é“ºå«ï¼Œå°±æ˜¯ç¼–å†™åç«¯é€»è¾‘äº†ï¼Œæˆ‘ä»¬åœ¨ <code>server/index.ts</code> æ–‡ä»¶ä¸­ç¼–å†™åç«¯é€»è¾‘ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p><div class="language-typescript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">db</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./db</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">publicProcedure</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">router</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./trpc</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">createHTTPServer</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">@trpc/server/adapters/standalone</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> z </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">zod</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> appRouter </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">router</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">userList</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> publicProcedure</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">query</span><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// Retrieve users from a datasource, this is an imaginary database</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">users</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">user</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">findMany</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">users</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">userById</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> publicProcedure</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">input</span><span style="color:#A6ACCD;">(z</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">object</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">id</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> z</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">string</span><span style="color:#A6ACCD;">() </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">query</span><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">({</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">input</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">id</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">input</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">user</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">user</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">findById</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">id</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">user</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">userCreate</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> publicProcedure</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">input</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">      z</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">object</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> z</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">string</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">email</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> z</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">string</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">password</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> z</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">string</span><span style="color:#A6ACCD;">() </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    )</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mutation</span><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">({</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">input</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">user</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">user</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">create</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">input</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">user</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// Export type router type signature,</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// NOT the router itself.</span></span>
<span class="line highlighted"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">AppRouter</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">typeof</span><span style="color:#A6ACCD;"> appRouter</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> server </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">createHTTPServer</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">router</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> appRouter</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">server</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">listen</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">3000</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>è¿™é‡Œæˆ‘ä»¬å¯¼å…¥äº† <code>db</code>ã€<code>publicProcedure</code> å’Œ <code>router</code>ï¼Œç„¶ååˆ›å»ºäº† <code>appRouter</code>ï¼Œ<code>appRouter</code> æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒåŒ…å«äº† <code>userList</code>ã€<code>userById</code> å’Œ <code>userCreate</code> ä¸‰ä¸ªå±æ€§ï¼Œè¿™ä¸‰ä¸ªå±æ€§åˆ†åˆ«å¯¹åº”äº† <code>publicProcedure.query</code>ã€<code>publicProcedure.query</code> å’Œ <code>publicProcedure.mutation</code>ï¼Œè¿™ä¸‰ä¸ªå±æ€§çš„å€¼éƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„æ•°æ®ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä»£ç çš„ç¬¬ 31 è¡Œæˆ‘æ ‡æ³¨äº†ä¸€ä¸‹ï¼Œè¿™é‡Œå¯¼å‡ºçš„æ˜¯ <code>AppRouter</code> ç±»å‹ï¼Œè€Œä¸æ˜¯ <code>appRouter</code> å¯¹è±¡ï¼Œè¿™æ˜¯å› ä¸º <code>appRouter</code> å¯¹è±¡ä¸­çš„ <code>userList</code>ã€<code>userById</code> å’Œ <code>userCreate</code> ä¸‰ä¸ªå±æ€§çš„ç±»å‹éƒ½æ˜¯ <code>Procedure</code>ï¼Œè€Œ <code>Procedure</code> æ˜¯ä¸€ä¸ªæ³›å‹ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¾“å…¥ç±»å‹ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¾“å‡ºç±»å‹ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¼å‡º <code>AppRouter</code> ç±»å‹ï¼Œè¿™æ ·åœ¨åé¢çš„ä»£ç ä¸­æ‰èƒ½ä½¿ç”¨ <code>AppRouter</code> ç±»å‹ã€‚</p><p>ä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨å‰ç«¯è°ƒç”¨åç«¯ api çš„æ—¶å€™å¯ä»¥ç›´æ¥é€šè¿‡ <code>.</code> å°±å¯ä»¥è·å¾—å¯¹åº”çš„å±æ€§å’Œæ–¹æ³•äº†ã€‚</p><p>åˆ°æ­¤ï¼Œæˆ‘ä»¬åç«¯çš„é€»è¾‘å·®ä¸å¤šå†™å®Œäº†ï¼Œå°†å¯¹åº”çš„ <code>appRouter</code> ä¼ å…¥ <code>createHTTPServer</code> å‡½æ•°ä¸­ï¼Œç„¶åç›‘å¬ 3000 ç«¯å£å³å¯ï¼Œä¸‹é¢æˆ‘ä»¬å³å°†ç¼–å†™å‰ç«¯é€»è¾‘ï¼Œæ¥è°ƒç”¨åç«¯çš„æ¥å£è¯•ä¸€è¯•ã€‚</p><h2 id="ç¼–å†™å‰ç«¯é€»è¾‘" tabindex="-1">ç¼–å†™å‰ç«¯é€»è¾‘ <a class="header-anchor" href="#ç¼–å†™å‰ç«¯é€»è¾‘" aria-label="Permalink to &quot;ç¼–å†™å‰ç«¯é€»è¾‘&quot;">â€‹</a></h2><p>ç”±äºå‰ç«¯åªç”¨è´Ÿè´£è°ƒç”¨ apiï¼Œæ‰€ä»¥ä»£ç å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå¦‚ <code>client/index.ts</code> æ‰€ç¤ºï¼š</p><div class="language-typescript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">createTRPCProxyClient</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">httpBatchLink</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">@trpc/client</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">AppRouter</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">../server</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//     ğŸ‘† **type-only** import</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// Pass AppRouter as generic here. ğŸ‘‡ This lets the \`trpc\` object know</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// what procedures are available on the server and their input/output types.</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> trpc </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">createTRPCProxyClient</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">AppRouter</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">links</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">httpBatchLink</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">url</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://localhost:3000</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">createdUser</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">trpc</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">userCreate</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mutate</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    name</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ä¸€ç™¾ä¸ªChocolate</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    email</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">chocolate@qq.com</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    password</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Chocolate</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">createdUser: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">createdUser</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">userCreated</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">trpc</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">userById</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">query</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> id</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">userCreated: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">userCreated</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">users</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">trpc</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">userList</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">query</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Users:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">users</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">main</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>è¿™é‡Œæˆ‘ä»¬å¯¼å…¥äº† <code>createTRPCProxyClient</code> å’Œ <code>httpBatchLink</code>ï¼Œç„¶ååˆ›å»ºäº† <code>trpc</code> å¯¹è±¡ï¼Œ<code>trpc</code> å¯¹è±¡å°±æ˜¯æˆ‘ä»¬ç”¨æ¥è°ƒç”¨åç«¯ api çš„å¯¹è±¡ï¼Œå®ƒçš„å±æ€§å’Œæ–¹æ³•å°±æ˜¯åç«¯ <code>appRouter</code> å¯¹è±¡ä¸­çš„ <code>userList</code>ã€<code>userById</code> å’Œ <code>userCreate</code> ä¸‰ä¸ªå±æ€§ï¼Œè¿™ä¸‰ä¸ªå±æ€§çš„ç±»å‹éƒ½æ˜¯ <code>Procedure</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ <code>.</code> æ¥è°ƒç”¨è¿™ä¸‰ä¸ªå±æ€§ã€‚</p><h3 id="ç¼–å†™-script-è„šæœ¬" tabindex="-1">ç¼–å†™ script è„šæœ¬ <a class="header-anchor" href="#ç¼–å†™-script-è„šæœ¬" aria-label="Permalink to &quot;ç¼–å†™ script è„šæœ¬&quot;">â€‹</a></h3><p>ä¸ºäº†è®©æˆ‘ä»¬å‰åç«¯ä»£ç è·‘èµ·æ¥ï¼Œè¿˜éœ€è¦ä¿®æ”¹ä¸€ä¸‹é¡¹ç›®çš„ script è„šæœ¬ï¼Œå¦‚ä¸‹ï¼š</p><div class="language-json line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">// xxx</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">scripts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">client:dev</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">esno client</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">server:dev</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">esno server</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">// ...</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>è¿™é‡Œæˆ‘æ˜¯ä½¿ç”¨çš„ <code>esno</code> æ¥æ‰§è¡Œæˆ‘ä»¬çš„ ts æ–‡ä»¶ã€‚ä¹Ÿéœ€è¦å®‰è£…ä¸€ä¸‹ï¼š</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">esno</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><blockquote><p><code>esno</code> æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒå¯ä»¥ç›´æ¥æ‰§è¡Œ ts æ–‡ä»¶ï¼Œè€Œä¸éœ€è¦æˆ‘ä»¬å…ˆç¼–è¯‘æˆ js æ–‡ä»¶ï¼Œç„¶åå†æ‰§è¡Œ js æ–‡ä»¶ï¼Œè¿™æ ·å°±å¯ä»¥çœå»ç¼–è¯‘çš„è¿‡ç¨‹äº†ã€‚</p></blockquote><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œ <code>npm run client:dev</code> å’Œ <code>npm run server:dev</code> æ¥åˆ†åˆ«å¯åŠ¨å‰ç«¯å’Œåç«¯äº†ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ‰§è¡Œ <code>npm run server:dev</code>ï¼Œç„¶åå†æ‰§è¡Œ <code>npm run client:dev</code>ï¼Œå› ä¸ºå‰ç«¯éœ€è¦è°ƒç”¨åç«¯çš„æ¥å£ï¼Œæ‰€ä»¥åç«¯å¿…é¡»å…ˆå¯åŠ¨èµ·æ¥ï¼Œå¦åˆ™å‰ç«¯å°±ä¼šæŠ¥é”™ã€‚</p><p>å½“ç„¶ï¼Œè¿™é‡Œå…¶å®ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>wait-port</code> ä»¥åŠ <code>npm-run-all</code> æ¥å®ç°å‰åç«¯ä¸€èµ·å¯åŠ¨ï¼Œæˆ‘ä»¬ä¼šåœ¨è¿›é˜¶ç¯‡æ¥ä»‹ç»ï¼Œè¿™é‡Œå°±å…ˆä¸å±•ç¤ºäº†ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹çœ‹æ‰“å°ç»“æœï¼š</p><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æˆåŠŸçš„è°ƒç”¨äº†åç«¯çš„æ¥å£ï¼Œè·å–åˆ°äº†æ•°æ®ã€‚</p><h2 id="æ€»ç»“" tabindex="-1">æ€»ç»“ <a class="header-anchor" href="#æ€»ç»“" aria-label="Permalink to &quot;æ€»ç»“&quot;">â€‹</a></h2><p>åˆ°æ­¤ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†ä¸€ä¸ªç®€å•çš„ tRPC é¡¹ç›®ï¼Œæˆ‘ä»¬ä½¿ç”¨ tRPC æ¥åˆ›å»ºäº†ä¸€ä¸ªåç«¯ apiï¼Œç„¶ååœ¨å‰ç«¯ä½¿ç”¨ tRPC æ¥è°ƒç”¨åç«¯çš„æ¥å£ï¼Œè·å–åˆ°äº†æ•°æ®ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ <code>httpBatchLink</code>ï¼Œä¹Ÿå°±æ˜¯ http åè®®ï¼Œå½“ç„¶ tRPC è¿˜æ”¯æŒå…¶ä»–çš„åè®®ï¼Œæ¯”å¦‚ <code>wsLink</code>ã€<code>grpcLink</code>ã€<code>reactQueryLink</code> ç­‰ç­‰ï¼Œå¯ä»¥ä»å®˜ç½‘æ–‡æ¡£ä¸­è¿›ä¸€æ­¥å­¦ä¹ ã€‚</p><h2 id="æ–‡ç« å‚è€ƒ" tabindex="-1">æ–‡ç« å‚è€ƒ <a class="header-anchor" href="#æ–‡ç« å‚è€ƒ" aria-label="Permalink to &quot;æ–‡ç« å‚è€ƒ&quot;">â€‹</a></h2><p><a href="https://trpc.io/docs/" target="_blank" rel="noreferrer">tRPC å®˜æ–¹æ–‡æ¡£</a></p><p><a href="https://www.youtube.com/watch?v=UfUbBWIFdJs" target="_blank" rel="noreferrer">Learn tRPC In 45 Minutes</a></p>`,47),e=[o];function r(t,c,y,D,F,i){return n(),a("div",null,e)}const u=s(l,[["render",r]]);export{A as __pageData,u as default};
